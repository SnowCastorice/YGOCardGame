<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YGO Pack Opener - 游戏王卡包开封模拟器</title>
<link rel="stylesheet" href="css/style.css?v=1.0.0">
</head>
<body>
    <!-- ====== 全局加载遮罩层 ====== -->
    <div id="loading-overlay" class="loading-overlay" style="display:none;">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <p class="loading-text">加载中...</p>
        </div>
    </div>

    <!-- ====== 顶部导航栏 ====== -->
    <header class="top-bar">
        <h1 class="game-title">YGO Pack Opener</h1>
        <!-- 货币显示栏 -->
        <div class="currency-bar">
            <div class="currency-item" id="currency-item-gold" title="点击兑换">
                <span class="currency-icon">🪙</span>
                <span class="currency-value" id="currency-balance-gold">0</span>
            </div>
            <div class="currency-item" id="currency-item-diamond" title="点击兑换">
                <span class="currency-icon">💎</span>
                <span class="currency-value" id="currency-balance-diamond">0</span>
            </div>
        </div>
        <!-- OCG / TCG 模式切换开关 -->
        <div class="mode-switch-container">
            <button id="btn-mode-ocg" class="mode-btn active" data-mode="ocg">OCG</button>
            <button id="btn-mode-tcg" class="mode-btn" data-mode="tcg">TCG</button>
        </div>
        <nav class="top-nav">
            <button id="btn-cache-manage" class="nav-btn">💾 缓存</button>
            <button id="btn-changelog" class="nav-btn">📋 日志</button>
            <button id="btn-dev-tools" class="nav-btn dev-btn">🔧</button>
        </nav>
    </header>

    <!-- ====== 主游戏区域 ====== -->
    <main class="game-area">
        <!-- 当前模式提示 -->
        <div id="mode-info" class="mode-info">
<span id="mode-info-text">🎌 OCG 模式（亚洲版） — 每包5张 | 中文名+日文名 | 数据源: YGOProDeck + YGOCDB</span>
        </div>

        <!-- 卡包选择区域 -->
        <section id="pack-select-section" class="section-panel">
            <h2 class="section-title">选择卡包</h2>
<p class="section-subtitle">OCG: 中文名+日文名 | TCG: 中文名+英文名 | 数据源: YGOProDeck + YGOCDB</p>
            <div id="pack-list" class="pack-list">
                <!-- 卡包列表会由 JS 动态生成 -->
            </div>
        </section>

        <!-- 开包按钮区域 -->
        <section id="open-pack-section" class="section-panel" style="display:none;">
            <div class="pack-info">
                <h2 id="current-pack-name" class="section-title"></h2>
                <p id="current-pack-desc" class="pack-desc"></p>
            </div>
            <div class="open-btn-container">
                <button id="btn-open-pack" class="btn-open-pack">🎴 开启卡包</button>
            </div>
            <button id="btn-back-to-packs" class="btn-secondary">← 返回选择卡包</button>
        </section>

        <!-- 开包动画遮罩层 -->
        <div id="opening-overlay" class="opening-overlay" style="display:none;">
            <div class="opening-animation">
                <div class="pack-tear">
                    <div class="pack-visual">🎴</div>
                    <p class="opening-text">正在开启卡包...</p>
                </div>
            </div>
        </div>

        <!-- 卡牌结果展示区域 -->
        <section id="result-section" class="section-panel" style="display:none;">
            <h2 class="section-title">开包结果</h2>
            <div id="cards-display" class="cards-display">
                <!-- 抽到的卡牌会由 JS 动态生成 -->
            </div>
            <div class="result-actions">
                <button id="btn-open-again" class="btn-open-pack">🎴 再开一包</button>
                <button id="btn-back-from-result" class="btn-secondary">← 返回选择卡包</button>
            </div>
        </section>
    </main>

    <!-- ====== 更新日志弹窗 ====== -->
    <div id="changelog-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h2>📋 更新日志</h2>
                <button id="btn-close-changelog" class="modal-close" onclick="document.getElementById('changelog-modal').classList.remove('active')">&times;</button>
            </div>
            <div id="changelog-content" class="modal-body">
                <!-- 更新日志内容由 JS 动态生成 -->
            </div>
        </div>
    </div>

    <!-- ====== 缓存管理弹窗 ====== -->
    <div id="cache-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h2>💾 缓存管理</h2>
                <button id="btn-close-cache" class="modal-close" onclick="document.getElementById('cache-modal').classList.remove('active')">&times;</button>
            </div>
            <div id="cache-content" class="modal-body">
                <!-- 缓存信息由 JS 动态生成 -->
            </div>
            <div class="modal-footer">
                <button id="btn-clear-cache" class="btn-danger">🗑️ 清除所有缓存</button>
            </div>
        </div>
    </div>

    <!-- ====== 开发者工具：CDN 卡图对比面板 ====== -->
    <div id="devtools-modal" class="modal-overlay">
        <div class="modal-content devtools-modal-content">
            <div class="modal-header">
                <h2>🔧 开发者工具</h2>
                <button id="btn-close-devtools" class="modal-close">&times;</button>
            </div>
            <div class="modal-body devtools-body">
                <!-- ▸ 板块一：快捷操作 -->
                <div class="devtools-section-card">
                    <h3 class="devtools-section-title">🛠️ 快捷操作</h3>
                    <div class="devtools-actions-btns">
                        <button id="btn-dev-add-gold" class="btn-devtools-action btn-dev-gold">🪙 添加 10000 金币</button>
                        <button id="btn-dev-reset-game" class="btn-devtools-action btn-dev-reset">🔄 重置游戏</button>
                    </div>
                    <p class="devtools-note">💡 重置游戏：仅重置货币余额，不清除缓存。若需清除缓存，请前往「💾 缓存管理」。</p>
                </div>

                <!-- ▸ 板块二：CDN 卡图对比 -->
                <div class="devtools-section-card">
                    <h3 class="devtools-section-title">🖼️ CDN 卡图对比</h3>
                    <!-- 当前模式信息（优先展示，让用户知道当前上下文） -->
                    <div id="devtools-mode-info" class="devtools-mode-info"></div>
                    <!-- 卡片ID输入区 -->
                    <div class="devtools-input-area">
                        <label for="devtools-card-id">卡片ID：</label>
                        <input type="text" id="devtools-card-id" placeholder="例如 89631139（青眼白龙）" />
                    </div>
                    <div class="devtools-input-actions">
                        <button id="btn-devtools-load" class="btn-devtools-action">🔍 加载对比</button>
                        <button id="btn-devtools-random" class="btn-devtools-action btn-devtools-random">🎲 随机卡片</button>
                    </div>
                    <!-- CDN 对比结果区 -->
                    <div id="devtools-compare-area" class="devtools-compare-area">
                        <p class="devtools-placeholder">输入卡片 ID 后点击「加载对比」，或使用「🎲 随机卡片」来测试</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ====== 货币兑换弹窗 ====== -->
    <div id="exchange-modal" class="modal-overlay">
        <div class="modal-content exchange-modal-content">
            <div class="modal-header">
                <h2>💱 货币兑换</h2>
                <button id="btn-close-exchange" class="modal-close">&times;</button>
            </div>
            <div id="exchange-content" class="modal-body">
                <!-- 兑换内容由 JS 动态生成 -->
            </div>
        </div>
    </div>

    <!-- ====== 卡牌图片放大查看器 ====== -->
    <div id="card-image-viewer" class="card-image-viewer">
        <span class="viewer-hint">点击任意位置关闭</span>
        <img class="viewer-image" src="" alt="卡牌大图">
        <div class="viewer-card-name"></div>
    </div>

    <!-- ====== 页脚 ====== -->
    <footer class="footer">
<p>YGO Pack Opener v1.0.0 | 游戏王卡包开封模拟器</p>
        <p class="footer-credit">
            外文数据: <a href="https://ygoprodeck.com/" target="_blank" rel="noopener">YGOProDeck</a> | 
            中文名称: <a href="https://ygocdb.com/" target="_blank" rel="noopener">YGOCDB</a> | 
            Yu-Gi-Oh! © <a href="https://www.konami.com/" target="_blank" rel="noopener">Konami</a>
        </p>
    </footer>

    <!-- 内联脚本：确保弹窗关闭按钮始终可用（不受外部JS缓存影响） -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // 通用弹窗关闭逻辑
        document.querySelectorAll('.modal-close').forEach(function(btn) {
            btn.addEventListener('click', function() {
                var modal = this.closest('.modal-overlay');
                if (modal) modal.classList.remove('active');
            });
        });
        // 点击弹窗遮罩层（外部区域）也能关闭
        document.querySelectorAll('.modal-overlay').forEach(function(overlay) {
            overlay.addEventListener('click', function(e) {
                if (e.target === this) this.classList.remove('active');
            });
        });
    });
    </script>

    <!-- 先加载离线备用数据，再加载 API 模块，最后加载游戏逻辑 -->
<script src="data/fallback_cards.js?v=1.0.0"></script>
    <script src="js/currency.js?v=1.0.0"></script>
    <script src="js/api.js?v=1.0.0"></script>
    <script src="js/game.js?v=1.0.0"></script>
</body>
</html>
